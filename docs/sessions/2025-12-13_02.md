# Session 2025-12-13 #02 - Audit DNA Complet + Narrative DNA V3.0

## Contexte
Suite de la Session #01 - Après correction du bug de classification tactique, objectif d'auditer toutes les dimensions DNA disponibles et créer un profil narratif complet V3.0 avec 18 dimensions + fingerprints 100% uniques.

## Réalisé

### 1. Audit Complet des Données DNA
- Identifié ~1123 métriques par équipe dans team_dna_unified_v2.json
- Cartographié 8 sections principales: tactical, defensive_line, defense, exploit, context, fbref, betting, meta
- Découvert que beaucoup de données "manquantes" étaient en fait dans defensive_line.* (GK, timing, gamestate, zones)

### 2. Audit des Dimensions Disponibles
- **CORE**: tactical_profile (100%), defensive_style (100%), ppda (58%), pressing_intensity (100%)
- **CHESS ENGINE**: goalkeeper (100%), timing (100%), gamestate (100%), zones (100%), set_pieces (100%)
- **MVP/ATTACK**: players_impact_dna (2324 joueurs), attacker_dna_v2 (1199 attaquants)
- **MANQUANT**: 8_tactical_axes (0%), attack_axis/width (crosses non scrapées)

### 3. Problème Données MVP Identifié
- players_impact_dna.json a des équipes MAL ASSIGNÉES
- Hugo Ekitike listé comme Liverpool (joue à Frankfurt)
- Viktor Gyokeres listé comme Arsenal (joue au Sporting)
- Données semblent être des projections de transferts ou erreurs de scraping

### 4. Création Narrative DNA V2.0
- Script initial créé avec intégration PPDA + MVP + timing
- 96 profils générés
- 48 fingerprints uniques
- Couverture: PPDA 90%, MVP 90%, Timing 81%, GK 100%

### 5. Création Narrative DNA V3.0 (Final)
- Script complet `/home/Mon_ps/scripts/generate_narrative_dna_v3.py`
- 18 dimensions extraites: tactical, goalkeeper, defenders, midfielders, attackers, timing, gamestate, set_pieces, zones, friction, exploit, context, betting
- Fingerprints 100% uniques (format: LIV_GEGE_P9.0_PS61_D0.55_M-COD4_G-ALI60)
- Marchés exploitables générés automatiquement
- Narratif texte pour chaque équipe

### 6. Exemples Fingerprints V3.0
- Liverpool: LIV_GEGE_P9.0_PS61_D0.55_M-COD4_G-ALI60
- Man City: MAN_POSS_P13.7_PS57_D1.55_M-ERL15_G-EDE66
- Arsenal: ARS_POSS_P10.4_PS58_D0.50_M-LEA4_G-DAV73
- West Ham: WES_LOW__P16.7_PS42_D0.70_M-JAR4_G-LUK62
- Brighton: BRI_GEGE_P9.5_PS51_D0.66_M-DAN7_G-BAR67

## Fichiers créés

### Scripts
- `/home/Mon_ps/scripts/generate_narrative_dna_v3.py` - Script génération DNA V3.0

### Données
- `/home/Mon_ps/data/quantum_v2/team_narrative_profiles_v2.json` - Profils V2.0 (48 fingerprints)
- `/home/Mon_ps/data/quantum_v2/team_narrative_dna_v3.json` - Profils V3.0 (96 fingerprints uniques)

## Problèmes identifiés (non résolus)

### 1. Données MVP Corrompues
- **Problème:** players_impact_dna.json a des joueurs assignés aux mauvaises équipes
- **Impact:** MVP calculé incorrect (Hugo Ekitike pour Liverpool au lieu de Salah)
- **Solution proposée:** Filtrer par league ou re-scraper depuis FBRef

### 2. Defender/Midfielder Betting Profiles
- **Problème:** Fichiers contiennent 0 défenseurs/milieux (structure dict au lieu de list)
- **Impact:** Sections defenders/midfielders vides dans DNA V3.0
- **Solution proposée:** Vérifier structure des fichiers source

### 3. PSG Nom Non Trouvé
- **Problème:** "Paris Saint Germain" vs "Paris Saint-Germain" mismatch
- **Impact:** Friction matrix échoue pour matchs PSG
- **Solution proposée:** Normaliser les noms d'équipes

## En cours / À faire
- [ ] Corriger players_impact_dna.json (équipes mal assignées)
- [ ] Corriger nom "Paris Saint Germain"
- [ ] Vérifier structure defender_betting_profiles.json
- [ ] Vérifier structure midfielder_betting_profiles.json
- [ ] Intégrer Narrative DNA V3.0 dans match_analyzer_v2.py
- [ ] Étendre ground truth ML au-delà de 39 équipes
- [ ] Revenir à DNA Profiler V2 (Session #05)

## Notes techniques

### Structure Fingerprint V3.0
```
{TEAM_3_CHARS}_{PROFILE_4_CHARS}_P{PPDA}_PS{POSS}_D{DIESEL}_M-{MVP_3_CHARS}{GOALS}_G-{GK_3_CHARS}{SR}
```

### Dimensions DNA V3.0
1. tactical (profile, ppda, possession, pressing)
2. goalkeeper (name, save_rate, status, timing, vulnerabilities)
3. defenders (starters, line_profile, resistance)
4. midfielders (starters, profile)
5. attackers (mvp, top_scorers, dependency)
6. timing (profile, diesel_factor, periods)
7. gamestate (behavior, comeback_rate)
8. set_pieces (offensive_threat, defensive_vulnerability)
9. zones (vulnerability_zone, zone_profile)
10. friction (multipliers vs styles)
11. exploit (vulnerabilities, exploit_paths)
12. context (league, formation, record)
13. betting (best_markets, timing_plays)

### Couverture Données V3.0
- PPDA: 96/96 (100%)
- MVP: 96/96 (100% - mais données incorrectes pour certains)
- GK: 96/96 (100%)
- Fingerprints: 96/96 (100% uniques)

## Durée Session
~2 heures (audit + création V2.0 + création V3.0)
