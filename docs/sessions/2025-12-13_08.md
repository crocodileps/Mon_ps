# Session 2025-12-13 #08 - DataManager V2.6 COMPLET

## Contexte
Continuation de Session #07 (Quantum Core MVP).
Objectif: Integrer Coach, Goalkeeper et Attackers DNA dans le DataManager.

## Realise

### 1. Audit PostgreSQL Complet
- Identifie `team_intelligence` (675 rows)
- Identifie `quantum.team_profiles` (99 rows) avec quantum_dna JSONB
- Analyse du schema quantum_dna (24 keys incluant card_dna, luck_dna, corner_dna)
- Identifie `coach_intelligence` et `coach_team_mapping`

### 2. Audit JSON DNA Files
- 72 fichiers DNA identifies
- Sources principales:
  - `team_dna_unified_v2.json` (5.8MB, 96 equipes)
  - `teams_context_dna.json` (489KB) - xG, momentum
  - `attacker_dna_v2.json` (523KB, 1199 joueurs)
  - `goalkeeper_dna_v4_4_final.json` (717KB, 96 gardiens)

### 3. DataManager V2.6 COMPLET
Architecture Hybrid Cascade:
```
PostgreSQL quantum.team_profiles
    â†“ fallback
JSON DNA Files
    â†“ fallback
Intelligent Imputation
```

#### Nouvelles Dataclasses
```python
@dataclass
class CoachData:
    name: str
    team: str
    style: str  # possession, counter, balanced

@dataclass
class GoalkeeperData:
    name: str
    team: str
    save_rate: float
    status: str  # ELITE, SOLID, AVERAGE, LEAKY
    exploits: List[str]

@dataclass
class AttackerData:
    name: str
    team: str
    goals: int
    xg: float
    threat_score: float
```

#### TeamData V2.6 Enrichi
- coach_name, coach_style
- goalkeeper_name, gk_save_rate, gk_status
- mvp_name, mvp_goals, mvp_dependency
- top_scorers list

### 4. Tests Valides
```
Liverpool:
  xG For: 2.45, xG Against: 1.44
  Coach: Arne Slot
  GK: Alisson Becker
  Sources: 10, Quality: 1.00

Manchester City:
  Coach: Pep Guardiola
  GK: Ederson
  MVP: Erling Haaland
```

## Fichiers Touches

### Modifies
- `/home/Mon_ps/quantum_core/data/manager.py` (V2.6 - ~740 lignes)
- `/home/Mon_ps/docs/CURRENT_TASK.md`

### Crees
- `/home/Mon_ps/quantum_core/data/manager_v25_backup.py`
- `/home/Mon_ps/docs/sessions/2025-12-13_08.md`

## Problemes Identifies

| Probleme | Impact | Solution Proposee |
|----------|--------|-------------------|
| attacker_dna_v2.json erreurs team | MVP incorrect (Ekitike sous Liverpool) | Nettoyer fichier JSON |
| PostgreSQL team_stats manquante | Fallback JSON fonctionne | Non bloquant |

## En cours / A faire

- [x] Audit PostgreSQL tables
- [x] Audit JSON DNA files
- [x] DataManager V2.6 avec Coach/GK/Attackers
- [ ] Nettoyer attacker_dna_v2.json
- [ ] Integrer Coach DNA dans friction matrix
- [ ] Utiliser GK status pour Clean Sheet predictions

## Notes Techniques

### Sources de Donnees V2.6
| Source | Type | Contenu |
|--------|------|---------|
| quantum.team_profiles | PostgreSQL | 99 equipes, quantum_dna JSONB |
| coach_intelligence | PostgreSQL | 151 colonnes stats coach |
| team_dna_unified_v2.json | JSON | 96 equipes DNA complet |
| goalkeeper_dna_v4_4_final.json | JSON | 96 gardiens |
| attacker_dna_v2.json | JSON | 1199 joueurs |

### Data Quality Score
```python
# Score 0.0 - 1.0
base_score = 0.3  # minimum (full imputation)
+ 0.35 si PostgreSQL data
+ 0.25 si JSON data
+ 0.10 si Coach data
+ 0.10 si GK data
- penalty si staleness > 24h
```

## Duree Session
~30 minutes
